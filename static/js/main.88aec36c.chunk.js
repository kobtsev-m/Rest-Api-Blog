(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{107:function(e,t,a){},109:function(e,t,a){},110:function(e,t,a){},114:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(19),c=a.n(r),i=(a(69),a(70),a(8)),o=a(5),l=a(17),d=a(11),j=a(12),b=a(28),u=a(14),m=a(13),h=a(35),p=a(117),O=a(59),g=a(34);var v=a(60).create({baseURL:"http://infinite-hamlet-30732.herokuapp.com/api/",headers:{"Content-type":"application/json"}}),A=function(){return v.get("posts/").then((function(e){return e.data}))},f=function(e){return v.get("posts/".concat(e)).then((function(e){return e.data}))},x=function(){return v.options("posts/").then((function(e){return t=e.data.actions.POST,Object.entries(t).reduce((function(e,t){return"choice"===t[1].type&&(e[t[0]]=t[1].choices.map((function(e){return{value:e.value,label:e.display_name}}))),e}),{});var t}))},N=function(){return v.get("categories/").then((function(e){return{categories:e.data.map((function(e){return{value:e.id,label:e.name}}))}}))},y=function(e,t){for(var a,n,s=(a=e,n=t,Object.entries(a).reduce((function(e,t){if(n.hasOwnProperty(t[0])){var a=Object(g.a)(t,2),s=a[0],r=a[1];e[s]=Array.isArray(r)?r.map((function(e){return e.value})):r.value}else e[t[0]]=t[1];return e}),{})),r=new FormData,c=0,i=Object.entries(s);c<i.length;c++){var o=Object(g.a)(i[c],2),l=o[0],d=o[1];if("object"===typeof d){var j,b=Object(O.a)(d);try{for(b.s();!(j=b.n()).done;){var u=j.value;r.append(l,u)}}catch(m){b.e(m)}finally{b.f()}}else r.append(l,d)}return console.log(r),v.post("posts/",r,{headers:{"Content-Type":"multipart/form-data"}})},C=function(e){return v.delete("posts/".concat(e))},D=function(){return v.get("categories/")},w=a(20),k=a(32),S=a(1);function P(e){var t=e.handleChange,a=e.errors,n=e.isSubmitted,s=Object(h.a)(e,["handleChange","errors","isSubmitted"]);return Object(S.jsxs)(p.a.Group,{controlId:"".concat(s.name,"Input"),children:[Object(S.jsxs)(p.a.Label,{children:[Object(k.capitalize)(s.name),s.required?"*":""]}),Object(S.jsx)(p.a.Control,Object(o.a)({onChange:function(e){t(Object(w.a)({},e.target.name,e.target.value))},isValid:n&&!a[s.name],isInvalid:!!a[s.name]},s)),Object(S.jsx)(p.a.Control.Feedback,{children:"Looks Good!"}),Object(S.jsx)(p.a.Control.Feedback,{type:"invalid",children:a[s.name]})]})}var F=function(e){return Object(S.jsx)(P,Object(o.a)({},e))},L=a(64);var z=function(e){var t=!!e.errors[e.name],a=e.isSubmitted&&!e.errors[e.name],n=t?"is-invalid":a?"is-valid":"",s={control:function(e){return t?Object(o.a)(Object(o.a)({},e),{},{borderColor:"#dc3545"}):a?Object(o.a)(Object(o.a)({},e),{},{borderColor:"#28a745"}):Object(o.a)({},e)}};return Object(S.jsxs)(p.a.Group,{controlId:"".concat(e.name,"Select"),children:[Object(S.jsxs)(p.a.Label,{children:[Object(k.capitalize)(e.name),e.required?"*":""]}),Object(S.jsx)(L.a,{isMulti:e.isMulti,name:e.name,onChange:function(t,a){e.handleChange(Object(w.a)({},a.name,t))},options:e.options[e.name],styles:s,className:n,value:e.value}),Object(S.jsx)(p.a.Control.Feedback,{children:"Looks Good!"}),Object(S.jsx)(p.a.Control.Feedback,{type:"invalid",children:e.errors[e.name]})]})},E=a(25),I=a(23),R=a(24),T=(a(107),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).handleDrag=function(e){e.preventDefault(),e.stopPropagation()},n.handleDragIn=function(e){e.preventDefault(),e.stopPropagation(),n.dragCounter++,e.dataTransfer.items&&e.dataTransfer.items.length>0&&n.setState({dragging:!0})},n.handleDragOut=function(e){e.preventDefault(),e.stopPropagation(),n.dragCounter--,0===n.dragCounter&&n.setState({dragging:!1})},n.handleDrop=function(e){e.preventDefault(),e.stopPropagation(),n.setState({dragging:!1}),e.dataTransfer.files&&e.dataTransfer.files.length>0&&(n.handleChange(e.dataTransfer.files),e.dataTransfer.clearData(),n.dragCounter=0)},n.handleChange=function(e){if(!Object(E.a)(e).some((function(e){return!e.name.match(/.(jpg|jpeg|png|gif)$/i)}))){var t=[].concat(Object(E.a)(n.state.images),Object(E.a)(e)),a=[].concat(Object(E.a)(n.state.imagesUrls),Object(E.a)(Object(E.a)(e).map((function(e){return URL.createObjectURL(e)}))));n.setState({images:t,imagesUrls:a}),n.props.handleChange(Object(w.a)({},n.props.name,t))}},n.handleDelete=function(e){var t=n.state.images.filter((function(t,a){return a!==e})),a=n.state.imagesUrls.filter((function(t,a){return a!==e}));n.setState({images:t,imagesUrls:a}),console.log(t),n.props.handleChange(Object(w.a)({},n.props.name,t))},n.state={images:[],imagesUrls:[],dragging:!1},n.dropRef=s.a.createRef(),n.dragCounter=0,n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var e=this.dropRef.current;e.addEventListener("dragenter",this.handleDragIn),e.addEventListener("dragleave",this.handleDragOut),e.addEventListener("dragover",this.handleDrag),e.addEventListener("drop",this.handleDrop)}},{key:"componentWillUnmount",value:function(){var e=this.dropRef.current;e.removeEventListener("dragenter",this.handleDragIn),e.removeEventListener("dragleave",this.handleDragOut),e.removeEventListener("dragover",this.handleDrag),e.removeEventListener("drop",this.handleDrop)}},{key:"render",value:function(){var e=this;return Object(S.jsxs)("div",{className:"form-group mb-2",children:[Object(S.jsx)("label",{children:"Post Images"}),Object(S.jsxs)("div",{className:"imageField border rounded p-3 mb-2",ref:this.dropRef,children:[this.state.dragging&&Object(S.jsx)("div",{className:"imageField__hover"}),Object(S.jsx)("div",{className:"d-flex",children:this.state.imagesUrls.length?this.state.imagesUrls.map((function(t,a){return Object(S.jsx)("div",{className:"imageField__image mr-2",style:{backgroundImage:"url(".concat(t,")")},children:Object(S.jsx)("button",{type:"button",className:"btn btn-sm btn-danger m-1",onClick:function(){return e.handleDelete(a)},children:Object(S.jsx)(I.a,{icon:R.d})})},a)})):Object(S.jsxs)("div",{className:"imageField__image w-100 d-flex align-items-center justify-content-center",children:[Object(S.jsx)(I.a,{icon:R.c,className:"h1"}),Object(S.jsx)("span",{className:"h4 text-muted ml-3",children:"Upload images"})]})})]}),Object(S.jsx)("input",{type:"file",multiple:!0,className:"d-none",id:"imageFieldInput",onChange:function(t){return e.handleChange(t.target.files)}}),Object(S.jsx)("label",{htmlFor:"imageFieldInput",className:"btn btn-white border w-100",children:"Browse"})]})}}]),a}(n.Component)),V=a(9);function Z(e){return Object(S.jsxs)(V.b,{to:e.to,className:"btn btn-white border",children:[Object(S.jsx)(I.a,{icon:R.b,className:"mr-2"}),Object(S.jsx)("span",{children:"Back"})]})}function M(e){return Object(S.jsx)("div",{className:"d-flex",children:Object(S.jsx)("button",{type:"submit",className:"btn btn-success col-12 col-md-3 ml-md-auto",children:e.text})})}function K(e){var t=e.handleSubmit,a=e.options,n=e.values,s=Object(h.a)(e,["handleSubmit","options","values"]);return Object(S.jsxs)(p.a,{className:"col-12 p-0",onSubmit:t,children:[Object(S.jsx)(F,Object(o.a)({name:"title",required:!0},s)),Object(S.jsx)(F,Object(o.a)({type:"textarea",name:"content",rows:3,required:!0},s)),Object(S.jsx)(z,Object(o.a)({isMulti:!0,name:"categories",options:a},s)),Object(S.jsx)(z,Object(o.a)({isMulti:!1,name:"status",options:a,value:n.status,required:!0},s)),Object(S.jsx)(T,Object(o.a)({name:"images"},s)),Object(S.jsx)(M,{text:"Create"})]})}var U={values:{title:"",status:{label:"published",value:"P"},content:"",categories:[],images:[]},options:{},errors:{},isSubmitted:!1},W=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).handleSubmit=function(e){e.preventDefault(),y(n.state.values,n.state.options).then((function(){n.redirect=!0,n.setState(Object(o.a)(Object(o.a)({},U),{},{isSubmitted:!0}))})).catch((function(e){n.setState({errors:e.response.data,isSubmitted:!0})}))},n.handleChange=function(e){n.setState({values:Object(o.a)(Object(o.a)({},n.state.values),e)})},n.state=U,n.handleChange=n.handleChange.bind(Object(b.a)(n)),n.handleSubmit=n.handleSubmit.bind(Object(b.a)(n)),n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var e=this;x().then((function(t){return e.setState({options:t})})),N().then((function(t){return Object(o.a)(Object(o.a)({},e.state.options),t)})).then((function(t){return e.setState({options:t})}))}},{key:"render",value:function(){return this.redirect?Object(S.jsx)(i.a,{to:"/posts"}):Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)(Z,{to:"/posts"})}),Object(S.jsx)("hr",{className:"row"}),Object(S.jsx)("div",{className:"row",children:Object(S.jsx)(K,Object(o.a)({handleSubmit:this.handleSubmit,handleChange:this.handleChange},this.state))})]})}}]),a}(n.Component),G=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(e){var n;return Object(d.a)(this,a),(n=t.call(this,e)).state={postData:{}},n}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.postId;f(t).then((function(t){return e.setState({postData:t})}))}},{key:"render",value:function(){var e=new Date(this.state.postData.updated),t=e.toLocaleDateString("en-GB"),a=e.toTimeString().slice(0,8);return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)(Z,{to:"/posts"})}),Object(S.jsx)("hr",{className:"row"}),Object(S.jsx)("div",{className:"row card mb-3",children:Object(S.jsxs)("div",{className:"row no-gutters",children:[Object(S.jsx)("div",{className:"col-md-4",children:Object(S.jsx)("img",{src:this.state.postData.images?this.state.postData.images[0].small:null,className:"card-img",alt:""})}),Object(S.jsx)("div",{className:"col-md-8",children:Object(S.jsxs)("div",{className:"card-body",children:[Object(S.jsx)("h5",{className:"card-title",children:this.state.postData.title}),Object(S.jsx)("p",{className:"card-text",children:this.state.postData.content}),Object(S.jsx)("p",{className:"card-text",children:Object(S.jsxs)("small",{className:"text-muted",children:["Last updated ",t,", ",a]})})]})})]})})]})}}]),a}(n.Component),B="SET-POSTS",Y="DELETE-POST",q={posts:[]};var X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:q,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case B:return Object(o.a)(Object(o.a)({},e),{},{posts:t.posts});case Y:return Object(o.a)(Object(o.a)({},e),{},{posts:e.posts.reduce((function(e,a){return a.id!==t.postId&&e.push(a),e}),[])});default:return e}},H=a(116),J=(a(109),{deletePost:function(e){return{type:Y,postId:e}}}),_=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){var e;Object(d.a)(this,a);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(e=t.call.apply(t,[this].concat(s))).onDelete=function(){C(e.props.id).then((function(){e.props.deletePost(e.props.id)}))},e}return Object(j.a)(a,[{key:"render",value:function(){var e=this.props.categories.map((function(e,t){return t?", ".concat(e.name):e.name}));return Object(S.jsxs)("div",{className:"card",children:[Object(S.jsx)("div",{className:"card-img-top",children:0===this.props.images.length?Object(S.jsx)("div",{className:"postCard__image",style:{backgroundImage:"url(".concat("data:image/jpeg;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAGQBAMAAACAGwOrAAAAG1BMVEUvLy9mZmY1NTU8PDxKSkpfX19RUVFYWFhDQ0NJKxXsAAAACXBIWXMAAA7EAAAOxAGVKw4bAAADtElEQVR4nO3bTXPbRBwHYNVxcI5dWsc9KkMLPTbt8HKMGZdzXGCmxwT6whHP8AEc6BQ+Npa0siU3cS068Qt6nkM22rU8O79Z/S1tnCQBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABg4zrP5tJtz2XndcPc2bbnsvP+S1jPbnE+O60bGp9yEJ7cwkT2gbAaEFYDwmpAWA0IqwFhNSCsBpbCGqXJN+P+L7PfHk7CH2nZd/Q69H8tX7MI691Z2dcZpbc80V2wFFaYfpXdzE+To6x5EPuOxtnRj9lBZzT6IbwazaRJcnWvPO+z/gbnvDXLYf05fpk+HN9LrgZPvxgWSyhML/vfp48vZxFmy6o0GzsclOfdub/RWW/Jclh/H89+PuofZE+KnfF53vc+j6kzyRZabWV1QxrPu/p8YzPeouWwJhdJtny+zldKcZmFyYt8rNdP83ZRszrzh+/J77c8z53QDeV21tPsMBS1Zzy+yJo7x3lfDKcT8s7qp+HleRKHppuZ7nYttmjytRSKkj0srq9eXpNCWY+Gd/OmEtbpg/gurajvs7B+jn7KDkOxVK6O42Dedze+9qSIphJWL1b4w+PNzHbLlmvWWd7EFRPDuoiDMZJKWEexwp+2or7fFFZxNRZZzKt4vJmq3sHHINtR3z+8Kc2beljT+murYRVlrCX1vVFY8aKrhlWUsZbU90ZhHXwYVlHhW1LfG4b1pNJUulpS3z91ZSX53etlO+r7p9asosK3pL43DCtvamFlFf6o+QbiflonrLM4eM19Vt7Xa0l9bxRWfLiphZUdnLSkvq8VVlm+T4on6voe/OSiNfV9rbDKzeO4w1cPa9Y5nt7mDHfIOmGVm8fjYgXVH24O77emvq8VVnxa7pYrqvblpG6/NfV9rbCeF2kMy03AyXnljE5Y/I3n/26xrZx/TfLasP4KL2fNt/NCP8zC65TvMAltqe/L3/y7/qb0URi8eR3mV9thGLx6Oz86bcv9+5phJc9nw4P5Z2DncnZYiW6D0915WYCPR/+kla7vKodt2Z9Zz0cus7bsz6znI2G1ZP99TavDau8XkK61OqzeYNVo66wOa6hkVa0M68B/sdSsDOvUVVizKqwvw4uNzWMv3BzWu7fhON3cRPbBzWGNK89A5G7+r803v904BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7Kt/AQMcfWRqVnDuAAAAAElFTkSuQmCC",")")}}):1===this.props.images.length?Object(S.jsx)("div",{className:"postCard__image",style:{backgroundImage:"url(".concat(this.props.images[0].small,")")}}):Object(S.jsx)(H.a,{interval:null,children:this.props.images.map((function(e,t){return Object(S.jsx)(H.a.Item,{className:"postCard__image",style:{backgroundImage:"url(".concat(e.small,")")}},t)}))})}),Object(S.jsxs)("div",{className:"card-body",children:[Object(S.jsx)("h5",{className:"card-title",children:this.props.title}),Object(S.jsx)("p",{className:"card-text",children:this.props.content})]}),Object(S.jsxs)("ul",{className:"list-group list-group-flush",children:[Object(S.jsxs)("li",{className:"list-group-item",children:["Owner: ",this.props.owner.username]}),Object(S.jsxs)("li",{className:"list-group-item",children:["Category: ",e]})]}),Object(S.jsxs)("div",{className:"card-body d-flex",children:[Object(S.jsx)("div",{className:"col-6 p-0 pr-1",children:Object(S.jsx)(V.b,{to:"posts/".concat(this.props.id),className:"btn btn-outline-dark w-100",children:"Open"})}),Object(S.jsx)("div",{className:"col-6 p-0 pl-1",children:Object(S.jsx)("button",{onClick:this.onDelete,className:"btn btn-outline-danger w-100",children:"Delete"})})]})]})}}]),a}(n.Component),Q=Object(l.b)(null,J)(_),$=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var e=this;A().then((function(t){return e.props.setPosts(t)}))}},{key:"render",value:function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)(V.b,{to:"/posts/add",className:"btn btn-dark ml-auto",children:"Add post"})}),Object(S.jsx)("hr",{className:"row my-3"}),Object(S.jsx)("div",{className:"row",children:this.props.posts.map((function(e){return Object(S.jsx)("div",{className:"col-12 col-md-6 col-lg-4 mb-2",children:Object(S.jsx)(Q,Object(o.a)({},e))},e.id)}))})]})}}]),a}(n.Component),ee={setPosts:function(e){return{type:B,posts:e}}},te=Object(l.b)(null,ee)($);var ae=Object(l.b)((function(e){return{postForm:e.postsData.postForm,postsList:{posts:e.postsData.posts}}}))((function(e){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)("span",{className:"h2 mb-1",children:"Posts"})}),Object(S.jsx)("hr",{className:"row my-3"}),Object(S.jsx)(i.b,{exact:!0,path:"/posts",render:function(){return Object(S.jsx)(te,Object(o.a)({},e.postsList))}}),Object(S.jsx)(i.b,{exact:!0,path:"/posts/add",render:function(){return Object(S.jsx)(W,Object(o.a)({},e.postForm))}}),Object(S.jsx)(i.b,{exact:!0,path:"/posts/:postId(\\d+)",component:G})]})})),ne="SET-CATEGORIES",se={categories:[]};var re=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ne:return Object(o.a)(Object(o.a)({},e),{},{categories:t.categories});default:return e}},ce=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(j.a)(a,[{key:"componentDidMount",value:function(){var e=this;D().then((function(t){return e.props.setCategories(t.data)}))}},{key:"render",value:function(){return Object(S.jsx)("div",{className:"row",children:this.props.categories.map((function(e){return Object(S.jsx)("div",{className:"col-12 mb-2",children:Object(S.jsxs)("div",{className:"card",children:[Object(S.jsxs)("h5",{className:"card-header",children:["ID: ",e.id]}),Object(S.jsxs)("div",{className:"card-body",children:[Object(S.jsx)("h5",{className:"card-title",children:e.name}),Object(S.jsx)("p",{className:"card-text",children:e.slug})]})]})},e.id)}))})}}]),a}(n.Component),ie={setCategories:function(e){return{type:ne,categories:e}}},oe=Object(l.b)(null,ie)(ce);var le=function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){var e=this;return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)("div",{className:"row",children:Object(S.jsx)("span",{className:"h2 mb-1",children:"Categories"})}),Object(S.jsx)("hr",{className:"row my-3"}),Object(S.jsx)(i.b,{exact:!0,path:"/categories",render:function(){return Object(S.jsx)(oe,{categories:e.props.categories})}})]})}}]),a}(n.Component),de=Object(l.b)((function(e){return e.categoriesData}))(le);var je=function(e){return Object(S.jsxs)("div",{className:"container py-3 py-md-4 px-4 px-md-0",children:[Object(S.jsx)(i.b,{exact:!0,path:"/",render:function(){return"Blog home page"}}),Object(S.jsx)(i.b,{path:"/posts",render:function(){return Object(S.jsx)(ae,{})}}),Object(S.jsx)(i.b,{path:"/categories",render:function(){return Object(S.jsx)(de,{})}})]})},be=(a(110),function(e){Object(u.a)(a,e);var t=Object(m.a)(a);function a(){return Object(d.a)(this,a),t.apply(this,arguments)}return Object(j.a)(a,[{key:"render",value:function(){return Object(S.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:[Object(S.jsx)(V.b,{className:"navbar-brand px-2",exact:!0,to:"/",children:Object(S.jsx)(I.a,{icon:R.a})}),Object(S.jsx)("button",{className:"navbar-toggler","data-toggle":"collapse","data-target":"#navbarContent",children:Object(S.jsx)("span",{className:"navbar-toggler-icon"})}),Object(S.jsx)("div",{className:"collapse navbar-collapse",id:"navbarContent",children:Object(S.jsxs)("ul",{className:"navbar-nav mr-auto",children:[Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(V.b,{className:"nav-link",exact:!0,to:"/",children:"Home"})}),Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(V.b,{className:"nav-link",to:"/posts",children:"Posts"})}),Object(S.jsx)("li",{className:"nav-item",children:Object(S.jsx)(V.b,{className:"nav-link",to:"/categories",children:"Categories"})})]})})]})}}]),a}(n.Component));var ue=function(){return Object(S.jsxs)(S.Fragment,{children:[Object(S.jsx)(be,{}),Object(S.jsx)(je,{})]})},me=(a(111),a(112),a(27)),he=Object(me.b)({postsData:X,categoriesData:re}),pe=Object(me.c)(he);window.store=pe;var Oe=pe,ge=Object(S.jsx)(l.a,{store:Oe,children:Object(S.jsx)(V.a,{children:Object(S.jsx)(ue,{})})});c.a.render(ge,document.getElementById("root"))},69:function(e,t,a){},70:function(e,t,a){}},[[114,1,2]]]);
//# sourceMappingURL=main.88aec36c.chunk.js.map